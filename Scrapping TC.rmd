---
title: "Scrapping TC"
author: "Jan Dimter Stransky, Cristobal Ortiz y Martín Venegas"
date: "10/24/2020"
output: html_document
---

# Web Scrapping TC
Descripción: Este RMarkdown realizará la técnica de web-scrapping a la página del Tribunal Constitucional. Se recuperará la información de las sentencias que por materia tengan *Control de constitucionalidad de leyes o tratados (Artículo 93 Nº1)* o *Constitucionalidad de proyectos de ley (Artículo 93 Nº3*. Se acotará a aquellas causas que hayan sido requerimientos por parte de parlamentarios.


```{r Configuración}
# Configuración del .rmd y carga de paquetes.
knitr::opts_chunk$set(echo = FALSE)
## Paquetes
library(tidyverse)
# Parsing of HTML/XML files
library(rvest)
# String manipulation
library(stringr)
# Verbose regular expressions
library(rebus)
# Eases DateTime manipulation
library(lubridate)
```

## Operación chihuahua
A continuación se desarrolla el web scrapping:
```{r Scrapping, echo=True}
#Carga de la web
TC_link <-'https://www.tribunalconstitucional.cl/sentencias/busqueda-avanzada'
#Lectura del HTML
TC_web <- read_html(TC_link)
#Carga del formulario y relleno de búsqueda
form <- html_form(TC_web)[[3]]
form2 <- set_values(form, materia= "4", texto="Requerimiento")
form2$url <- ""
TC_session <- html_session("https://www.tribunalconstitucional.cl/sentencias/busqueda-avanzada")
TC_conform <- submit_form(session=TC_session, form=form2)
#Lectura del resultado
TC_html <- read_html(TC_conform)
#Extracción tabla de resultados
TC_table <- html_table(TC_conform, fill=TRUE)[[2]]
```